<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boom & Doom</title>
    
    <meta name="description" content="Boom & Doom: Rust Raid & Crafting Calculator.">
    <meta property="og:title" content="Boom & Doom">
    <meta property="og:description" content="SpoÄÃ­tej si raid. NaplÃ¡nuj zkÃ¡zu.">
    <meta property="og:type" content="website">

    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#8a1c1c">
    <link rel="icon" type="image/png" href="img/icon-192.png">
    <link rel="apple-touch-icon" href="img/icon-192.png">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@6.11.0/css/flag-icons.min.css"/>
    
    <style>
        :root {
            --bg-color: #121212;
            --panel-color: #1e1e1e;
            --accent-color: #d32f2f;
            --btn-color: #c62828;
            --btn-hover: #e53935;
            --btn-reset: #424242;
            --text-color: #e0e0e0;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            padding: 20px;
            margin: 0;
            min-height: 100vh;
        }
        .container {
            background-color: var(--panel-color);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 25px rgba(0,0,0,0.8);
            max-width: 600px;
            width: 100%;
            display: flex;
            flex-direction: column;
            border-top: 4px solid var(--accent-color);
            position: relative;
        }
        
        /* HEADER LAYOUT */
        .header-top {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 25px;
            gap: 15px;
        }
        
        .title-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .app-logo {
            width: 45px;
            height: 45px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(211, 47, 47, 0.3);
        }

        h1 { 
            color: var(--accent-color); 
            margin: 0; 
            font-size: 1.8rem; 
            text-transform: uppercase; 
            letter-spacing: 2px; 
            font-weight: 800; 
            text-shadow: 0 0 15px rgba(211, 47, 47, 0.4);
            white-space: nowrap; 
        }

        .lang-buttons {
            display: flex;
            gap: 8px;
        }

        /* --- DESKTOP GRID LAYOUT --- */
        @media (min-width: 700px) {
            .header-top {
                display: grid;
                grid-template-columns: 1fr auto 1fr;
                align-items: start;
                margin-bottom: 10px;
            }
            .title-wrapper {
                grid-column: 2; 
                margin-top: 15px;
            }
            .lang-buttons {
                grid-column: 3; 
                justify-self: end; 
                margin-top: -15px;
            }
        }

        .flag-btn {
            background: #141414;
            border: 2px solid #444;
            border-radius: 50%;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.2s;
            overflow: hidden;
            padding: 0;
            filter: grayscale(100%);
        }
        .flag-btn span { font-size: 24px; line-height: 1em; }
        .flag-btn:hover, .flag-btn.active {
            filter: grayscale(0%);
            border-color: var(--accent-color);
            transform: scale(1.1);
        }
        
        /* TABS */
        .tabs {
            display: flex;
            margin-bottom: 20px;
            background: #000;
            border-radius: 6px;
            padding: 5px;
        }
        .tab-btn {
            flex: 1;
            padding: 12px;
            background: transparent;
            border: none;
            color: #666;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            border-radius: 4px;
            transition: 0.2s;
        }
        .tab-btn.active {
            background: var(--accent-color);
            color: white;
            box-shadow: 0 0 10px rgba(211, 47, 47, 0.4);
        }
        
        /* Views */
        .view-section { display: none; animation: fadeIn 0.3s ease-in-out; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Form Elements */
        label { display: block; margin-bottom: 8px; font-weight: bold; margin-top: 15px; font-size: 0.9em; color: #aaa;}
        input, select {
            width: 100%;
            padding: 12px;
            background-color: #0a0a0a;
            border: 1px solid #333;
            color: white;
            border-radius: 4px;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        /* Buttons Group */
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 25px;
        }

        button.calc-btn {
            flex: 2;
            padding: 15px;
            background-color: var(--btn-color);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 18px;
            cursor: pointer;
            font-weight: bold;
            text-transform: uppercase;
            transition: 0.2s;
            box-shadow: 0 4px 0 #8c1b1b;
        }
        button.calc-btn:hover { background-color: var(--btn-hover); transform: translateY(1px); box-shadow: 0 3px 0 #8c1b1b; }
        button.calc-btn:active { transform: translateY(4px); box-shadow: none; }

        button.reset-btn {
            flex: 1;
            padding: 15px;
            background-color: var(--btn-reset);
            color: #aaa;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            font-weight: bold;
            text-transform: uppercase;
            transition: 0.2s;
        }
        button.reset-btn:hover { background-color: #555; color: white; }
        
        /* Results */
        .result-box {
            margin-top: 25px;
            padding: 20px;
            background-color: #0a0a0a;
            border-left: 5px solid var(--accent-color);
            display: none;
            border-radius: 4px;
        }
        
        /* Raid Table */
        .raid-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .raid-table th { text-align: left; color: #888; font-size: 0.8em; padding-bottom: 10px; border-bottom: 1px solid #333; }
        .raid-table td { padding: 12px 0; border-bottom: 1px solid #222; vertical-align: middle;}
        
        .raid-method-flex {
            display: flex;
            align-items: center;
        }
        .raid-method-icon { width: 28px; height: 28px; margin-right: 10px; object-fit: contain; }
        
        .sulfur-cost { color: #ffca28; font-weight: bold; font-size: 0.9em; }
        .item-count { font-size: 1.1em; font-weight: bold; color: #fff; }

        .item-image { display: block; margin: 0 auto 15px auto; max-width: 100px; height: auto; }
        .big-number { font-size: 1.5em; color: var(--accent-color); font-weight: bold; text-align: center; }
        .section-title { color: #888; text-transform: uppercase; font-size: 0.85em; margin-top: 20px; margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 5px;}
        
        ul { list-style-type: none; padding: 0; }
        ul li { background: #161616; margin-bottom: 5px; padding: 8px; border-radius: 4px; display: flex; justify-content: space-between; align-items: center;}
        .val { color: #fff; font-weight: bold; }
        
        .instruction {
            background-color: #1a1a1a;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            border: 1px solid #333;
            line-height: 1.6;
        }
        .instruction span { color: #ef5350; font-weight: bold; }
        
        /* Install Button - Hidden on Desktop */
        #installBtn {
            display: none; width: 100%; padding: 10px; background-color: #333;
            color: #fff; border: 1px solid #555; border-radius: 4px; margin-bottom: 20px;
            cursor: pointer; text-align: center; font-size: 14px;
        }
        
        @media (min-width: 768px) {
            #installBtn { display: none !important; }
        }
    </style>
</head>
<body>

<div class="container">
    <button id="installBtn">ðŸ“² Install App</button>

    <div class="header-top">
        <div class="title-wrapper">
            <img src="img/icon-192.png" alt="Logo" class="app-logo">
            <h1>Boom & Doom</h1>
        </div>
        <div class="lang-buttons">
            <button class="flag-btn active" onclick="setLang('en')" id="btn-en"><span class="fi fi-us"></span></button>
            <button class="flag-btn" onclick="setLang('cs')" id="btn-cs"><span class="fi fi-cz"></span></button>
            <button class="flag-btn" onclick="setLang('ru')" id="btn-ru"><span class="fi fi-ru"></span></button>
            <button class="flag-btn" onclick="setLang('zh')" id="btn-zh"><span class="fi fi-cn"></span></button>
        </div>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('craft')" id="t_tabCraft">Crafting</button>
        <button class="tab-btn" onclick="switchTab('raid')" id="t_tabRaid">Raid Calc</button>
    </div>

    <div id="view-craft" class="view-section active">
        <label for="itemType" id="t_selectItem">Select Item</label>
        <select id="itemType">
            </select>

        <label for="sulfur" id="t_enterSulfur">Sulfur Amount</label>
        <input type="number" id="sulfur" placeholder="50000">

        <div class="btn-group">
            <button onclick="calculateCraft()" id="t_calculateBtn" class="calc-btn">Calculate</button>
            <button onclick="resetCraft()" id="t_resetBtn" class="reset-btn">Reset</button>
        </div>

        <div id="craftResult" class="result-box">
            <img id="resultImage" src="" alt="Item" class="item-image">
            <div style="text-align: center; margin-bottom: 20px;">
                <div id="t_youCanCraft">You can craft:</div>
                <div id="finalCount" class="big-number">0</div>
                <div id="itemNameDisplay" style="color:#aaa;"></div>
            </div>
            <div class="section-title" id="t_sulfurManagement">1. Sulfur Management</div>
            <div class="instruction">
                <span id="t_step1">Take</span> <span id="sulfurToGP">0</span> <span id="t_sulfurRaw">Sulfur</span>.<br>
                <span id="t_step2">Craft it into</span> <span id="gpCount">0</span> <span id="t_gp">Gunpowder</span>.
            </div>
            <div class="instruction" id="expInstructionBox">
                <span id="t_step3">Keep</span> <span id="sulfurToKeep">0</span> <span id="t_sulfurRaw2">Sulfur</span> <span id="t_inInventory">raw in inventory</span>.<br>
                <span id="t_step4">Use it to craft</span> <span id="expCount">0</span> <span id="expLabel">Explosives</span>.
            </div>
            <div class="section-title" id="t_otherMaterials">2. Other Materials Needed</div>
            <ul id="materialsList"></ul>
        </div>
    </div>

    <div id="view-raid" class="view-section">
        <label id="t_selectTarget">Select Target</label>
        <select id="targetType" onchange="calculateRaid()">
            </select>

        <label id="t_targetCountLabel">Number of Targets (e.g. 5 walls)</label>
        <input type="number" id="targetCount" value="1" min="1" oninput="calculateRaid()">

        <div id="raidResult" class="result-box" style="display:block;">
            
            <img id="raidTargetImage" src="" alt="Target" class="item-image" style="display:none;">

            <div class="section-title" id="t_raidOptions">Recommended Methods</div>
            <table class="raid-table">
                <thead>
                    <tr>
                        <th id="t_method">Method</th>
                        <th id="t_quantity">Amount</th>
                        <th id="t_cost">Total Sulfur</th>
                    </tr>
                </thead>
                <tbody id="raidTableBody">
                    </tbody>
            </table>
            <div style="text-align:center; margin-top:15px; font-size:0.8em; color:#666;">
                * Costs include crafting explosives & GP.
            </div>
        </div>
    </div>

</div>

<script>
    // --- TRANSLATIONS ---
    const translations = {
        en: {
            tabCraft: "Crafting",
            tabRaid: "Raid / Doom",
            selectItem: "What to craft?",
            enterSulfur: "Total Sulfur Amount",
            calculateBtn: "Calculate",
            resetBtn: "Reset",
            youCanCraft: "You can craft:",
            sulfurManagement: "1. Sulfur Management",
            otherMaterials: "2. Other Materials Needed",
            step1: "Take",
            step2: "Cook into",
            step3: "Keep",
            step4: "Use for",
            sulfurRaw: "Sulfur",
            gp: "Gunpowder",
            explosives: "Explosives",
            inInventory: "raw",
            leftover: "Leftover",
            useForAmmo: "Directly for Ammo",
            selectTarget: "Select Target to Destroy",
            targetCountLabel: "Number of Targets",
            raidOptions: "Destruction Methods (Cheapest first)",
            method: "Weapon",
            quantity: "Amount",
            cost: "Total Sulfur",
            items: {
                rocket: "Rocket", c4: "C4", hv: "HV Rocket", incen: "Incendiary Rocket",
                exp556: "Explosive Ammo", satchel: "Satchel Charge", beancan: "Beancan Grenade",
                charcoal: "Charcoal", frags: "Fragments", fuel: "LGF", pipe: "Pipe", tech: "Tech Trash", cloth: "Cloth"
            },
            targets: {
                woodWall: "Wood Wall / Door",
                stoneWall: "Stone Wall / Foundation",
                metalWall: "Sheet Metal Wall",
                armoredWall: "Armored Wall",
                sheetDoor: "Sheet Metal Door",
                garageDoor: "Garage Door",
                armoredDoor: "Armored Door",
                highWood: "High External Wood",
                highStone: "High External Stone"
            }
        },
        cs: {
            tabCraft: "VÃ½roba (Crafting)",
            tabRaid: "Raid (Doom)",
            selectItem: "Co chceÅ¡ vyrÃ¡bÄ›t?",
            enterSulfur: "MnoÅ¾stvÃ­ sulfuru",
            calculateBtn: "SpoÄÃ­tat",
            resetBtn: "Reset",
            youCanCraft: "MÅ¯Å¾eÅ¡ vyrobit:",
            sulfurManagement: "1. ManaÅ¾ment Sulfuru",
            otherMaterials: "2. DalÅ¡Ã­ suroviny",
            step1: "Vezmi",
            step2: "UdÄ›lej z nÄ›j",
            step3: "Nech si",
            step4: "PouÅ¾ij na",
            sulfurRaw: "Sulfuru",
            gp: "Gunpowder",
            explosives: "Explosives",
            inInventory: "v inventÃ¡Å™i",
            leftover: "Zbytek",
            useForAmmo: "PÅ™Ã­mo do nÃ¡bojÅ¯",
            selectTarget: "Co chceÅ¡ zniÄit?",
            targetCountLabel: "PoÄet cÃ­lÅ¯ (napÅ™. 10 zdÃ­)",
            raidOptions: "MoÅ¾nosti niÄenÃ­ (Od nejlevnÄ›jÅ¡Ã­ho)",
            method: "ZbraÅˆ",
            quantity: "PoÄet",
            cost: "Cena Sulfuru",
            items: {
                rocket: "Raketa", c4: "C4", hv: "HV Raketa", incen: "ZÃ¡palnÃ¡ Raketa",
                exp556: "ExplozivnÃ­ 5.56", satchel: "Satchel Charge", beancan: "Beancan",
                charcoal: "UhlÃ­", frags: "Fragmenty", fuel: "Palivo", pipe: "Trubka", tech: "Tech Trash", cloth: "LÃ¡tka"
            },
            targets: {
                woodWall: "DÅ™evÄ›nÃ¡ stÄ›na / DveÅ™e",
                stoneWall: "KamennÃ¡ stÄ›na / ZÃ¡klady",
                metalWall: "PlechovÃ¡ stÄ›na (Sheet)",
                armoredWall: "PancÃ©Å™ovÃ¡ stÄ›na (HQM)",
                sheetDoor: "PlechovÃ© dveÅ™e (Sheet)",
                garageDoor: "GarÃ¡Å¾ovÃ¡ vrata (Garage)",
                armoredDoor: "PancÃ©Å™ovÃ© dveÅ™e (Armored)",
                highWood: "VysokÃ¡ dÅ™evÄ›nÃ¡ zeÄ",
                highStone: "VysokÃ¡ kamennÃ¡ zeÄ"
            }
        },
        ru: {
            tabCraft: "ÐšÑ€Ð°Ñ„Ñ‚",
            tabRaid: "Ð ÐµÐ¹Ð´ (Doom)",
            selectItem: "Ð§Ñ‚Ð¾ ÐºÑ€Ð°Ñ„Ñ‚Ð¸Ð¼?",
            enterSulfur: "ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¡ÐµÑ€Ñ‹",
            calculateBtn: "Ð Ð°ÑÑÑ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ",
            resetBtn: "Ð¡Ð±Ñ€Ð¾Ñ",
            youCanCraft: "ÐœÐ¾Ð¶Ð½Ð¾ ÑÐºÑ€Ð°Ñ„Ñ‚Ð¸Ñ‚ÑŒ:",
            sulfurManagement: "1. Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐµÑ€Ð¾Ð¹",
            otherMaterials: "2. Ð¢Ñ€ÐµÐ±ÑƒÐµÐ¼Ñ‹Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹",
            step1: "Ð’Ð¾Ð·ÑŒÐ¼Ð¸",
            step2: "Ð¡ÐºÑ€Ð°Ñ„Ñ‚Ð¸",
            step3: "ÐžÑÑ‚Ð°Ð²ÑŒ",
            step4: "Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ð´Ð»Ñ",
            sulfurRaw: "Ð¡ÐµÑ€Ñ‹",
            gp: "ÐŸÐ¾Ñ€Ð¾Ñ…Ð°",
            explosives: "Ð’Ð·Ñ€Ñ‹Ð²Ñ‡Ð°Ñ‚ÐºÐ¸",
            inInventory: "Ð² Ð¸Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€Ðµ",
            leftover: "ÐžÑÑ‚Ð°Ñ‚Ð¾Ðº",
            useForAmmo: "ÐŸÑ€ÑÐ¼Ð¾ Ð² Ð¿Ð°Ñ‚Ñ€Ð¾Ð½Ñ‹",
            selectTarget: "Ð§Ñ‚Ð¾ Ð»Ð¾Ð¼Ð°ÐµÐ¼?",
            targetCountLabel: "ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ñ†ÐµÐ»ÐµÐ¹",
            raidOptions: "ÐœÐµÑ‚Ð¾Ð´Ñ‹ Ñ€ÐµÐ¹Ð´Ð° (Ð”ÐµÑˆÐµÐ²Ñ‹Ðµ ÑÐ²ÐµÑ€Ñ…Ñƒ)",
            method: "ÐžÑ€ÑƒÐ¶Ð¸Ðµ",
            quantity: "ÐšÐ¾Ð»-Ð²Ð¾",
            cost: "Ð¡ÐµÑ€Ð°",
            items: {
                rocket: "Ð Ð°ÐºÐµÑ‚Ð°", c4: "C4", hv: "HV Ð Ð°ÐºÐµÑ‚Ð°", incen: "Ð—Ð°Ð¶Ð¸Ð³. Ñ€Ð°ÐºÐµÑ‚Ð°",
                exp556: "Ð Ð°Ð·Ñ€Ñ‹Ð²Ð½Ñ‹Ðµ", satchel: "Ð¡Ð°Ñ‡ÐµÐ»ÑŒ", beancan: "Ð‘Ð¸Ð½ÐºÐ°Ð½",
                charcoal: "Ð£Ð³Ð¾Ð»ÑŒ", frags: "Ð¤Ñ€Ð°Ð³Ð¼ÐµÐ½Ñ‚Ñ‹", fuel: "Ð¢Ð¾Ð¿Ð»ÐµÐ²Ð¾", pipe: "Ð¢Ñ€ÑƒÐ±Ð°", tech: "ÐœÐ¸ÐºÑ€Ð¾ÑÑ…ÐµÐ¼Ñ‹", cloth: "Ð¢ÐºÐ°Ð½ÑŒ"
            },
            targets: {
                woodWall: "Ð”ÐµÑ€ÐµÐ²ÑÐ½Ð½Ð°Ñ ÑÑ‚ÐµÐ½Ð°",
                stoneWall: "ÐšÐ°Ð¼ÐµÐ½Ð½Ð°Ñ ÑÑ‚ÐµÐ½Ð°",
                metalWall: "ÐœÐµÑ‚Ð°Ð»Ð»Ð¸Ñ‡ÐµÑÐºÐ°Ñ ÑÑ‚ÐµÐ½Ð°",
                armoredWall: "ÐœÐ’Ðš ÑÑ‚ÐµÐ½Ð°",
                sheetDoor: "ÐœÐµÑ‚Ð°Ð»Ð»Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð´Ð²ÐµÑ€ÑŒ",
                garageDoor: "Ð“Ð°Ñ€Ð°Ð¶Ð½Ð°Ñ Ð´Ð²ÐµÑ€ÑŒ",
                armoredDoor: "ÐœÐ’Ðš Ð´Ð²ÐµÑ€ÑŒ",
                highWood: "Ð’Ñ‹ÑÐ¾ÐºÐ°Ñ Ð´ÐµÑ€ÐµÐ²ÑÐ½Ð½Ð°Ñ",
                highStone: "Ð’Ñ‹ÑÐ¾ÐºÐ°Ñ ÐºÐ°Ð¼ÐµÐ½Ð½Ð°Ñ"
            }
        },
        zh: {
            tabCraft: "åˆ¶ä½œ",
            tabRaid: "æ‹†å®¶ (Doom)",
            selectItem: "ä½ æƒ³åˆ¶é€ ä»€ä¹ˆï¼Ÿ",
            enterSulfur: "ç¡«ç£ºæ€»é‡",
            calculateBtn: "è®¡ç®—",
            resetBtn: "é‡ç½®",
            youCanCraft: "ä½ å¯ä»¥åˆ¶é€ ï¼š",
            sulfurManagement: "1. ç¡«ç£ºåˆ†é…",
            otherMaterials: "2. å…¶ä»–æ‰€éœ€ææ–™",
            step1: "å–å‡º",
            step2: "åˆ¶ä½œæˆ",
            step3: "ä¿ç•™",
            step4: "ç”¨äºŽåˆ¶ä½œ",
            sulfurRaw: "ç¡«ç£º",
            gp: "ç«è¯",
            explosives: "ç‚¸è¯",
            inInventory: "åœ¨èƒŒåŒ…ä¸­",
            leftover: "å‰©ä½™",
            useForAmmo: "ç›´æŽ¥ç”¨äºŽå¼¹è¯",
            selectTarget: "ç›®æ ‡å»ºç­‘",
            targetCountLabel: "ç›®æ ‡æ•°é‡",
            raidOptions: "æ‹†é™¤æ–¹æ³• (æœ€ä¾¿å®œä¼˜å…ˆ)",
            method: "æ­¦å™¨",
            quantity: "æ•°é‡",
            cost: "ç¡«ç£ºæˆæœ¬",
            items: {
                rocket: "ç«ç®­", c4: "C4", hv: "é«˜é€Ÿç«ç®­", incen: "ç‡ƒçƒ§ç«ç®­",
                exp556: "çˆ†ç‚¸å¼¹è¯", satchel: "ç‚¸è¯åŒ… (Satchel)", beancan: "è±†ç½é›·",
                charcoal: "æœ¨ç‚­", frags: "é‡‘å±žç¢Žç‰‡", fuel: "ä½Žçº§ç‡ƒæ–™", pipe: "é‡‘å±žç®¡", tech: "ç§‘æŠ€é›¶ä»¶", cloth: "å¸ƒ"
            },
            targets: {
                woodWall: "æœ¨å¢™ / é—¨",
                stoneWall: "çŸ³å¢™ / åœ°åŸº",
                metalWall: "é“å¢™ (Sheet)",
                armoredWall: "åˆé‡‘å¢™ (HQM)",
                sheetDoor: "é“é—¨",
                garageDoor: "å·å¸˜é—¨ (Garage)",
                armoredDoor: "åˆé‡‘é—¨",
                highWood: "é«˜å¤–æœ¨å¢™",
                highStone: "é«˜å¤–çŸ³å¢™"
            }
        }
    };

    // --- CRAFTING RECIPES ---
    // PoznÃ¡mka: imgUrl jsou online odkazy. Pokud chceÅ¡ offline verzi, 
    // stÃ¡hni si obrÃ¡zky do sloÅ¾ky img/ a pÅ™epiÅ¡ cesty (napÅ™. "img/rocket.png").
    const recipes = {
        rocket: { id: "rocket", sulfurTotal: 1400, gpPerItem: 650, explosivesPerItem: 10, rawSulfurToKeep: 100, imgUrl: "https://rustlabs.com/img/items180/ammo.rocket.basic.png", other: [{id:"charcoal", amount:1950},{id:"frags", amount:100},{id:"fuel", amount:30},{id:"pipe", amount:2}] },
        c4: { id: "c4", sulfurTotal: 2200, gpPerItem: 1000, explosivesPerItem: 20, rawSulfurToKeep: 200, imgUrl: "https://rustlabs.com/img/items180/explosive.timed.png", other: [{id:"charcoal", amount:3000},{id:"frags", amount:200},{id:"fuel", amount:60},{id:"tech", amount:2},{id:"cloth", amount:5}] },
        satchel: { id: "satchel", sulfurTotal: 480, gpPerItem: 240, explosivesPerItem: 0, rawSulfurToKeep: 0, imgUrl: "https://rustlabs.com/img/items180/explosive.satchel.png", other: [{id:"charcoal", amount:720}, {id:"frags", amount:80}, {id:"cloth", amount:10}, {id:"rope", amount:1}] },
        exp556: { id: "exp556", sulfurTotal: 25, gpPerItem: 10, explosivesPerItem: 0, rawSulfurToKeep: 5, imgUrl: "https://rustlabs.com/img/items180/ammo.rifle.explosive.png", other: [] }, 
        hv: { id: "hv", sulfurTotal: 200, gpPerItem: 100, explosivesPerItem: 0, rawSulfurToKeep: 0, imgUrl: "https://rustlabs.com/img/items180/ammo.rocket.hv.png", other: [{id:"charcoal", amount:300},{id:"pipe", amount:1}] },
        incen: { id: "incen", sulfurTotal: 610, gpPerItem: 300, explosivesPerItem: 1, rawSulfurToKeep: 10, imgUrl: "https://rustlabs.com/img/items180/ammo.rocket.fire.png", other: [] },
        beancan: { id: "beancan", sulfurTotal: 120, gpPerItem: 60, explosivesPerItem: 0, rawSulfurToKeep: 0, imgUrl: "https://rustlabs.com/img/items180/grenade.beancan.png", other: [] }
    };

    // --- RAID DATA (Updated with Images) ---
    // Pro offline pouÅ¾itÃ­ stÃ¡hni obrÃ¡zky do sloÅ¾ky img/ a zmÄ›Åˆ cesty.
    const raidTargets = {
        woodWall: { hp: 250, imgUrl: "https://rustlabs.com/img/items180/wood.png", methods: { rocket: 2, satchel: 3, exp556: 49, c4: 1 } },
        stoneWall: { hp: 500, imgUrl: "https://rustlabs.com/img/items180/stones.png", methods: { rocket: 4, satchel: 10, exp556: 185, c4: 2 } },
        metalWall: { hp: 1000, imgUrl: "https://rustlabs.com/img/items180/metal.fragments.png", methods: { rocket: 8, satchel: 23, exp556: 400, c4: 4 } },
        armoredWall: { hp: 2000, imgUrl: "https://rustlabs.com/img/items180/metal.refined.png", methods: { rocket: 15, satchel: 46, exp556: 799, c4: 8 } },
        sheetDoor: { hp: 250, imgUrl: "https://rustlabs.com/img/items180/door.hinged.metal.png", methods: { rocket: 1, satchel: 4, exp556: 63, c4: 1 } },
        garageDoor: { hp: 600, imgUrl: "https://rustlabs.com/img/items180/wall.frame.garagedoor.png", methods: { rocket: 3, satchel: 9, exp556: 150, c4: 2 } },
        armoredDoor: { hp: 1000, imgUrl: "https://rustlabs.com/img/items180/door.hinged.toptier.png", methods: { rocket: 5, satchel: 15, exp556: 250, c4: 3 } },
        highWood: { hp: 500, imgUrl: "https://rustlabs.com/img/items180/wall.external.high.wood.png", methods: { rocket: 3, satchel: 6, exp556: 98, c4: 2 } },
        highStone: { hp: 500, imgUrl: "https://rustlabs.com/img/items180/wall.external.high.stone.png", methods: { rocket: 4, satchel: 10, exp556: 185, c4: 2 } }
    };

    let currentLang = "en";

    function switchTab(tab) {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('t_tab' + (tab.charAt(0).toUpperCase() + tab.slice(1))).classList.add('active');
        document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
        document.getElementById('view-' + tab).classList.add('active');
    }

    function setLang(lang) {
        currentLang = lang;
        
        // Save to LocalStorage (Persist language)
        localStorage.setItem('rust_lang', lang);

        document.querySelectorAll('.flag-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById('btn-' + lang).classList.add('active');
        updateUI();
        calculateCraft();
        calculateRaid();
    }

    function updateUI() {
        const t = translations[currentLang];
        document.getElementById('t_tabCraft').innerText = t.tabCraft;
        document.getElementById('t_tabRaid').innerText = t.tabRaid;
        document.getElementById('t_selectItem').innerText = t.selectItem;
        document.getElementById('t_enterSulfur').innerText = t.enterSulfur;
        document.getElementById('t_calculateBtn').innerText = t.calculateBtn;
        document.getElementById('t_resetBtn').innerText = t.resetBtn;
        document.getElementById('t_youCanCraft').innerText = t.youCanCraft;
        document.getElementById('t_sulfurManagement').innerText = t.sulfurManagement;
        document.getElementById('t_otherMaterials').innerText = t.otherMaterials;
        document.getElementById('t_step1').innerText = t.step1;
        document.getElementById('t_step2').innerText = t.step2;
        document.getElementById('t_step3').innerText = t.step3;
        document.getElementById('t_sulfurRaw').innerText = t.sulfurRaw;
        document.getElementById('t_sulfurRaw2').innerText = t.sulfurRaw;
        document.getElementById('t_gp').innerText = t.gp;
        document.getElementById('t_inInventory').innerText = t.inInventory;
        document.getElementById('t_selectTarget').innerText = t.selectTarget;
        document.getElementById('t_targetCountLabel').innerText = t.targetCountLabel;
        document.getElementById('t_raidOptions').innerText = t.raidOptions;
        document.getElementById('t_method').innerText = t.method;
        document.getElementById('t_quantity').innerText = t.quantity;
        document.getElementById('t_cost').innerText = t.cost;
        populateCraftSelect(t);
        populateRaidSelect(t);
    }

    function populateCraftSelect(t) {
        const select = document.getElementById('itemType');
        const savedVal = select.value;
        select.innerHTML = "";
        for (const [key, value] of Object.entries(recipes)) {
            if(key === 'beancan') continue;
            const opt = document.createElement('option');
            opt.value = key;
            opt.innerText = t.items[value.id];
            select.appendChild(opt);
        }
        if (savedVal && recipes[savedVal]) select.value = savedVal;
    }

    function populateRaidSelect(t) {
        const select = document.getElementById('targetType');
        const savedVal = select.value;
        select.innerHTML = "";
        for (const [key, value] of Object.entries(raidTargets)) {
            const opt = document.createElement('option');
            opt.value = key;
            opt.innerText = t.targets[key];
            select.appendChild(opt);
        }
        if (savedVal && raidTargets[savedVal]) select.value = savedVal;
    }

    function resetCraft() {
        document.getElementById('sulfur').value = "";
        document.getElementById('craftResult').style.display = 'none';
    }

    function calculateCraft() {
        const sulfurInput = parseInt(document.getElementById('sulfur').value);
        const type = document.getElementById('itemType').value;
        const recipe = recipes[type];
        const t = translations[currentLang];
        if (isNaN(sulfurInput) || sulfurInput <= 0) return;
        const maxItems = Math.floor(sulfurInput / recipe.sulfurTotal);
        if (maxItems === 0) { alert(`Not enough Sulfur!`); return; }
        const totalGP = maxItems * recipe.gpPerItem;
        const sulfurForGP = totalGP * 2;
        const totalExp = maxItems * recipe.explosivesPerItem;
        const sulfurReserved = maxItems * recipe.rawSulfurToKeep;
        document.getElementById('resultImage').src = recipe.imgUrl;
        let countText = maxItems + " x " + t.items[recipe.id];
        if(recipe.id === 'exp556') countText += ` (${maxItems} bullets)`;
        document.getElementById('finalCount').innerText = countText;
        const leftover = sulfurInput - (maxItems * recipe.sulfurTotal);
        document.getElementById('itemNameDisplay').innerText = `(${t.leftover}: ${leftover})`;
        document.getElementById('sulfurToGP').innerText = sulfurForGP.toLocaleString();
        document.getElementById('gpCount').innerText = totalGP.toLocaleString();
        const expBox = document.getElementById('expInstructionBox');
        if (recipe.rawSulfurToKeep > 0) {
            expBox.style.display = 'block';
            document.getElementById('sulfurToKeep').innerText = sulfurReserved.toLocaleString();
            document.getElementById('t_step4').innerText = recipe.explosivesPerItem > 0 ? t.step4 : t.useForAmmo;
            document.getElementById('expCount').innerText = recipe.explosivesPerItem > 0 ? totalExp.toLocaleString() : "";
            document.getElementById('expLabel').innerText = recipe.explosivesPerItem > 0 ? " " + t.explosives : "";
        } else {
            expBox.style.display = 'none';
        }
        const listEl = document.getElementById('materialsList');
        listEl.innerHTML = "";
        recipe.other.forEach(mat => {
            const totalNeeded = mat.amount * maxItems;
            const li = document.createElement('li');
            li.innerHTML = `<span>${t.items[mat.id] || mat.id}</span> <span class="val">${totalNeeded.toLocaleString()}</span>`;
            listEl.appendChild(li);
        });
        document.getElementById('craftResult').style.display = 'block';
    }

    function calculateRaid() {
        const targetKey = document.getElementById('targetType').value;
        const countInput = document.getElementById('targetCount').value;
        const count = Math.max(1, parseInt(countInput) || 1);

        const target = raidTargets[targetKey];
        const t = translations[currentLang];
        
        // Show Image
        const imgEl = document.getElementById('raidTargetImage');
        if(target.imgUrl) {
            imgEl.src = target.imgUrl;
            imgEl.style.display = 'block';
        } else {
            imgEl.style.display = 'none';
        }

        const tbody = document.getElementById('raidTableBody');
        tbody.innerHTML = "";
        let methods = [];
        for (const [weaponKey, amountPerOne] of Object.entries(target.methods)) {
            const recipe = recipes[weaponKey];
            if (!recipe) continue;
            
            const totalAmount = amountPerOne * count;
            const totalSulfur = totalAmount * recipe.sulfurTotal;
            
            methods.push({ key: weaponKey, name: t.items[weaponKey], amount: totalAmount, cost: totalSulfur, img: recipe.imgUrl });
        }
        methods.sort((a, b) => a.cost - b.cost);
        methods.forEach(m => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>
                    <div class="raid-method-flex">
                        <img src="${m.img}" class="raid-method-icon">
                        <span>${m.name}</span>
                    </div>
                </td>
                <td class="item-count">${m.amount}</td>
                <td class="sulfur-cost">${m.cost.toLocaleString()}</td>
            `;
            tbody.appendChild(tr);
        });
    }

    // PWA Logic
    let deferredPrompt;
    const installBtn = document.getElementById('installBtn');
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault(); deferredPrompt = e; installBtn.style.display = 'block';
    });
    installBtn.addEventListener('click', async () => {
        if (deferredPrompt) { deferredPrompt.prompt(); deferredPrompt = null; installBtn.style.display = 'none'; }
    });
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => navigator.serviceWorker.register('./sw.js'));
    }

    // --- INITIALIZATION ---
    // Load saved language or default to 'en'
    const savedLang = localStorage.getItem('rust_lang');
    if (savedLang) {
        setLang(savedLang);
    } else {
        setLang('en');
    }

</script>
</body>
</html>
